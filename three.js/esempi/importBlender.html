<!DOCTYPE html>
<html>
<head>
	<title>ThreeJS</title>
	<script src="http://127.0.0.1:8080/js/three.js"></script>
</head>
<body>
	<script>
	//dichiaro le variabili d'ambiente che mi serviranno durante l'esecuzione
	var camera, scene, renderer;

	var t=0;
	//eseguo l'init e l'animate, il primo verrà eseguito una sola volta, mentre il secondo
	//richiamerà ricorsivamente se stesso, i nomi posso essere cambiati naturalmente, vedere sotto..
	init();
	animate();

	function init(){
		//creo la scena, ovvero il contenitore in cui inserirò tutti gli elementi che voglio visualizzare
		scene = new THREE.Scene();
		
		//creo la telecamera di tipo prospettico, ovvero che rispetta la prospettiva
		//i parametri sono spiegati sui docs di three.js, ma in linea di massima sono sempre questi
		camera = new THREE.PerspectiveCamera ( 75, window.innerWidth/window.innerHeight, 1, 10000);
		
		//posiziono la telecamera in x=0 y=0 e z=5 e la inserisco all'interno della scena
		camera.position.z = 10;
		scene.add(camera);

		
		//importo il file figure.js
		var loader = new THREE.JSONLoader();
		loader.load('figure.js', function( geometry, materials) {
			var object = new THREE.Mesh( geometry, new THREE.MeshFaceMaterial(materials));
	        object.scale.set( 2, 2, 2 );
	        object.position.set(0,0,0);

	        object.castShadow = true;
	        object.receiveShadow = true;

	        scene.add(object);
	    });

		/*

		//..
		//qui creo tutte le figure e le luci e le aggiugo alla scena come ho fatto per la telecamera
		//..

		*/

		var spotlight = new THREE.SpotLight(0xffffff);
        spotlight.position.set(20,30,10);
        spotlight.shadowCameraVisible = true;
        //spotlight.shadowDarkness = 0.25;
        spotlight.intensity = 2;
        //spotlight.shadowCameraFov = 100;
        // must enable shadow casting ability for the light
        spotlight.castShadow = true;
        scene.add(spotlight);

		//creao l'oggetto renderer, che si occuperà di fare il rendering con webGl,
		//e lo aggiungo al body della pagina web.
		renderer = new THREE.WebGLRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );
        document.body.appendChild( renderer.domElement );
	}

	function animate(){
		//dico alla libreria three.js di richiamare la funzione animate, ovvero mestesso 
		//ad ogni nuovo frame, quindi qui inserirò tutte le modifiche che voglio vare alla mia
		//scena per animarla
		requestAnimationFrame(animate);
		
		//rotazione della telecamera intorno alla scena
		t+=0.01;
		camera.position.x = Math.sin(t) * 10;
		camera.position.z = Math.cos(t) * 10;
		camera.lookAt(scene.position);
		/*

		//..
		//faccio tutte le animazioni o le modifiche alla mia scena
		//..

		*/

		//faccio il renderig del nuovo frame modificato, dando per arcomento la scena e la telecamera
		renderer.render(scene, camera);
	}
	</script>	
</body>
</html>