<html>
    <head>
        <title>test terra</title>        
        <!--<script src="package.require.js"></script>
        <script src="threex.atmospheredatgui.js"></script>
        <script src="threex.atmospherematerial.js"></script>
        <script src="threex.planets.js"></script>-->
    </head>
    <body>
        <script src="http://127.0.0.1:8080/js/three.js"></script>
        <script>

            var camera, scene, renderer;
            var geometry, material, mesh;
            var t = 0;

            var cube1, cube2;

            var light;

            init();

            function init() {

                camera = new THREE.PerspectiveCamera(45, document.body.clientWidth / document.body.clientHeight, 1, 10000);
                camera.position.z = 300;

                scene = new THREE.Scene();


                //CUBE1
                cube1 = new THREE.Mesh(
                        new THREE.CubeGeometry(50, 50, 50),
                        new THREE.MeshLambertMaterial({color: 0x00FF00}));
                cube1.position.y = 10;
                scene.add(cube1);

                //CUBE2
                cube2 = new THREE.Mesh(
                        new THREE.CubeGeometry(30, 30, 30),
                        new THREE.MeshLambertMaterial({color: 0xFF0000}));
                cube2.position.x = 80;
                cube2.position.y = 80;
                cube2.position.z = 80;
                scene.add(cube2);

                //TERRENO
                var planeGeo = new THREE.PlaneGeometry(400, 400, 10, 10);
                var planeMat = new THREE.MeshLambertMaterial({color: 0xFFFFFF});
                var plane = new THREE.Mesh(planeGeo, planeMat);
                plane.rotation.x = -Math.PI / 2;
                plane.position.y = -25;
                plane.receiveShadow = true;
                scene.add(plane);

                ////////////////////////////////////////LUCI
                light = new THREE.SpotLight();
                light.position.set(170, 330, -160);
                light.castShadow = true;
                scene.add(light);

                ////////////////////////////////////////OMBRE
                // attiva le ombre a livello render
                

                // attiva l'ombra a livello del punto luce
                

                // attiva l'ombra a livello oggetti
                cube1.castShadow = true;
                //cube1.receiveShadow = true;
                cube2.castShadow = true;
                //cube2.receiveShadow = true;

                 renderer = new THREE.WebGLRenderer({antialias: true});

                renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.shadowMapEnabled = true;
                document.body.appendChild(renderer.domElement);
                renderer.setClearColorHex(0xFFFFFF, 1.0);
                renderer.clear();


            }

            function animate() {
                //chiamata ricorsiva a me stesso
                requestAnimationFrame(animate);
                //temporizzazione
                t += 0.01;


                //MOVIMENTO CAMERA

                camera.position.x = Math.sin(t) * 300;
                camera.position.y = 150;
                camera.position.z = Math.cos(t) * 300;


                // you need to update lookAt on every frame
                camera.lookAt(scene.position);

                //ANIMAZIONI CUBE1
                cube1.rotation.z = t;

                //ANIMAZIONI CUBE2
                cube2.rotation.z = t * 2;
                cube2.rotation.x = t * 3;
                cube2.position.x = Math.cos(t) * 85;
                cube2.position.y = 60 - Math.sin(t) * 25;
                cube2.position.z = Math.sin(t) * 85;
                
                renderer.render(scene, camera);
            }

            animate();

        </script>
    </body>
</html>